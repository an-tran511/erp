/* Modern CSS: @layer for cascade control */
@layer components {
  /* Modern CSS: @property for typed custom properties (better performance & validation) */
  @property --button-height {
    syntax: '<length>';
    inherits: false;
    initial-value: 2rem;
  }

  @property --button-padding-x {
    syntax: '<length>';
    inherits: false;
    initial-value: 0.75rem;
  }

  @property --button-radius {
    syntax: '<length>';
    inherits: false;
    initial-value: var(--vpb-radius-default);
  }

  /* Modern CSS: Native nesting (2023+ spec) */
  .root {
    /* Compact web app sizes - Nova style with reduced padding */
    --button-height-xs: 1.5rem; /* 24px - extra small, very compact */
    --button-height-sm: 1.75rem; /* 28px - smallest, compact */
    --button-height-md: 2rem; /* 32px - default */
    --button-height-lg: 2.25rem; /* 36px */
    --button-height-xl: 2.5rem; /* 40px */

    --button-padding-x-xs: 0.375rem; /* 6px - extra small padding */
    --button-padding-x-sm: 0.5rem; /* 8px */
    --button-padding-x-md: 0.75rem; /* 12px - default */
    --button-padding-x-lg: 1rem; /* 16px */
    --button-padding-x-xl: 1.25rem; /* 20px */

    --button-height: var(--button-height-md);
    --button-padding-x: var(--button-padding-x-md);
    --button-color: var(--vpb-color-white);
    --button-bg: var(--vpb-primary-color-filled);
    --button-hover: var(--vpb-primary-color-filled-hover);
    --button-bd: transparent;
    --button-hover-color: var(--button-color);
    --button-fz: var(--vpb-font-size-md);
    --button-radius: var(--vpb-radius-default);

    /* Modern CSS: Logical properties (2022+ spec) */
    user-select: none;
    font-weight: 600;
    position: relative;
    line-height: 1;
    text-align: center;
    overflow: hidden;
    inline-size: auto;
    cursor: pointer;
    display: inline-block;
    border-radius: var(--button-radius);
    font-size: var(--button-fz);
    background: var(--button-bg);
    border: 1.5px solid var(--button-bd);
    color: var(--button-color);
    block-size: var(--button-height);
    padding-inline: var(--button-padding-x);
    vertical-align: middle;

    /* Modern CSS: Single transition property with shorthand */
    transition:
      background-color 150ms ease,
      border-color 150ms ease,
      color 150ms ease,
      transform 100ms ease;

    /* Modern CSS: Native nesting for pseudo-elements */
    &::before {
      content: '';
      pointer-events: none;
      position: absolute;
      inset: -1px; /* Modern shorthand for top/right/bottom/left */
      border-radius: var(--button-radius);
      transform: translateY(-100%);
      opacity: 0;
      filter: blur(12px);
      transition:
        transform 150ms ease,
        opacity 100ms ease;
    }

    /* Modern CSS: :where() for lower specificity, :has() for complex selectors */
    &:where([data-block]) {
      display: block;
      inline-size: 100%;
    }

    &:where([data-with-left-section]) {
      padding-inline-start: calc(var(--button-padding-x) / 1.5);
    }

    &:where([data-with-right-section]) {
      padding-inline-end: calc(var(--button-padding-x) / 1.5);
    }

    /* Modern CSS: :is() for grouping selectors */
    &:where(:is(:disabled, [data-disabled]):not([data-loading])) {
      cursor: not-allowed;
      border: 1px solid transparent;
      transform: none;
      color: var(--vpb-color-disabled-color);
      background: var(--vpb-color-disabled);
      border-color: var(--vpb-color-disabled-border);
    }

    /* Modern CSS: :has() for complex state management */
    &:where([data-loading]) {
      cursor: not-allowed;
      transform: none;

      &::before {
        transform: translateY(0);
        opacity: 1;
      }

      & .inner {
        opacity: 0;
        transform: translateY(100%);
      }

      & .label {
        opacity: 0.2;
      }

      & .loader {
        opacity: 1;
        transform: translate(-50%, calc(-50% + 1px));
      }
    }

    /* Modern CSS: :not() with multiple selectors */
    &:hover:where(:not(:is([data-loading], :disabled, [data-disabled]))) {
      background-color: var(
        --button-hover,
        var(--vpb-primary-color-filled-hover)
      );
      color: var(--button-hover-color, var(--button-color));
      border-color: var(--button-bd-hover, var(--button-bd));
    }

    /* Click animation - Mantine style press effect */
    &[data-pressed]:not([data-loading]):not(:disabled):not([data-disabled]),
    &:active:not([data-loading]):not(:disabled):not([data-disabled]) {
      transform: scale(0.97);
    }

    /* Modern CSS: :focus-visible for better accessibility */
    &:focus-visible {
      outline: 2px solid var(--vpb-color-indigo-9);
      outline-offset: 2px;
    }

    /* Modern CSS: Container queries support (if needed in future) */
    @container (min-width: 20rem) {
      /* Future: responsive button adjustments */
    }
  }

  /* Modern CSS: Color scheme detection with color-mix() */
  :root[data-vpb-color-scheme='light'] .root::before,
  :host([data-vpb-color-scheme='light']) .root::before {
    background-color: color-mix(in srgb, white 15%, transparent);
  }

  :root[data-vpb-color-scheme='dark'] .root::before,
  :host([data-vpb-color-scheme='dark']) .root::before {
    background-color: color-mix(in srgb, black 15%, transparent);
  }

  /* Modern CSS: Native nesting for child elements */
  .inner {
    display: flex;
    align-items: center;
    justify-content: var(--button-justify, center);
    block-size: 100%;
    overflow: visible;
    transition:
      transform 150ms ease,
      opacity 150ms ease;
  }

  .label {
    white-space: nowrap;
    block-size: 100%;
    overflow: hidden;
    display: flex;
    align-items: center;
    opacity: 1;
  }

  .section {
    display: flex;
    align-items: center;

    /* Modern CSS: Attribute selectors with nesting */
    &[data-position='left'] {
      margin-inline-end: var(--vpb-space-2);
    }

    &[data-position='right'] {
      margin-inline-start: var(--vpb-space-2);
    }
  }

  .loader {
    position: absolute;
    /* Modern CSS: Logical positioning with inset shorthand */
    inset-block-start: 50%;
    inset-inline-start: 50%;
    transform: translate(-50%, -50%);
    opacity: 0;
    transition:
      opacity 150ms ease,
      transform 150ms ease;
    pointer-events: none;
    color: currentColor;
  }

  .loaderIcon {
    width: 100%;
    height: 100%;
    animation: button-spin 1s linear infinite;
  }

  @keyframes button-spin {
    to {
      transform: rotate(360deg);
    }
  }
}

/* All variant, size, and color logic is now in TypeScript (Button.vars.ts, Button.utils.ts) */
/* CSS variables are set directly via inline styles - no data attribute selectors needed */
